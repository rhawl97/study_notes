# 1. 스파크 응용 프로그램의 해부

## 1) **개요**

- 드라이버, 마스터, 클러스터 매니저
- executor, worker → 워커 노드 실행
- 클라이언트가 스파크 응용 프로그램 제출 → 스파크 응용 프로그램이 계획, 스케줄링, 실행, 모니터링

## 2) **스파크 드라이버**

**1.1 드라이버**

스파크 프로그램을 실행 및 계획 → 결과를 클라이언트에게 반환

(1) 스파크 세션 생성

<aside>
🧐 스파크 세션?
: 스파크 클러스터에 대한 연결 → 응용 프로그램의 시작 부분에서 인스턴스화 → 프로그램 전체에 사용
: 스파크 콘텍스트, sparkconf, master, executors 등 모든 속성을 지님

</aside>

```python
from pyspark.sql import SparkSession
spark = SparkSession.builder\
				.master("s....).appName("....").config("...").getOrCreate().....
```

(2) 응용 프로그램 계획

- 요청된 transformation과 action에 대해 노드의 DAG(데이터 흐름을 나타내는 수학적 구조) 작성

(3) 응용 프로그램 조직화

- DAG에 정의된 stage와 task의 실행 설계
- 작업 실행에 사용되는 리소스 추적

## 3) **스파크 작업자(worker) 및 실행자(executor)**

- Executor: DAG 작업이 실행되는 프로세스
    - 슬레이브 노드 or 작업자의 리소스 예약
    - 보통 많은 실행자로 구성 → 병렬 실행
- Worker: 실행자 프로세스를 호스팅
    - 실행자가 특정 시점에 할당됨

## 4) 스파크 마스터와 클러스터 매니저

**1.0 개요**

- 스파크 드라이버: 스파크를 실행하는 데 필요한 작업 계획 및 조정
- 마스터 및 클러스터 매니저: 분산 클러스터 리소스를 예약 및 할당하는 중앙 시스템
    
    → 둘은 분리될 수도 있고, 하나의 프로세스로 결합될 수도 있음
    

**1.1 스파크 마스터와 클러스터 매니저**

- 스파크 마스터
    
    : 클러스터 리소스 요청, worker 노드에 리소스나 컨테이너 할당, 진행 상황 모니터링
    
- 클러스터 매니저
    
    : worker 노드 모니터링, 각 노드의 리소스 예약